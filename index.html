<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CGPA Calculator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
    <div class="top-bar">
        <h2>CGPA Calculator</h2>
        <button class="toggle-btn" onclick="toggleDarkMode()">ðŸŒ™</button>
    </div>

    <label>Number of Subjects</label>
    <input type="number" id="numSubjects" min="1" value="3">

    <div id="subjects"></div>

    <label>Previous CGPA</label>
    <input type="number" id="prevCGPA" step="0.01" placeholder="e.g. 8.50">

    <label>Previous Semester Credits</label>
    <input type="number" id="prevCredits" step="0.1" placeholder="e.g. 20">

    <button onclick="calculateCGPA()">Calculate CGPA</button>
    <button class="reset-btn" onclick="resetCalculator()">Reset</button>

    <div class="result hidden" id="result"></div>

    <table class="summary hidden" id="summary">
        <thead>
            <tr>
                <th>Subject</th>
                <th>Grade</th>
                <th>Credits</th>
                <th>Points</th>
            </tr>
        </thead>
        <tbody id="summaryBody"></tbody>
    </table>
</div>

<script>
const subjectsDiv = document.getElementById("subjects");
const numSubjectsInput = document.getElementById("numSubjects");
const resultBox = document.getElementById("result");
const summaryTable = document.getElementById("summary");
const summaryBody = document.getElementById("summaryBody");

const gradeMap = { O:10, A:9, B:8, C:7, D:6, E:5, F:0 };

function generateSubjects() {
    subjectsDiv.innerHTML = "";
    let n = parseInt(numSubjectsInput.value);

    for (let i = 1; i <= n; i++) {
        subjectsDiv.innerHTML += `
            <div class="subject">
                <input type="text" id="name${i}" placeholder="Subject name">
                <select id="grade${i}">
                    <option value="">Grade</option>
                    <option value="O">O</option>
                    <option value="A">A</option>
                    <option value="B">B</option>
                    <option value="C">C</option>
                    <option value="D">D</option>
                    <option value="E">E</option>
                    <option value="F">F</option>
                </select>
                <input type="number" id="credits${i}" placeholder="Credits">
            </div>
        `;
    }
}

numSubjectsInput.addEventListener("change", generateSubjects);
window.onload = generateSubjects;

function calculateCGPA() {
    let n = parseInt(numSubjectsInput.value);
    let totalWeighted = 0;
    let totalCredits = 0;
    summaryBody.innerHTML = "";

    for (let i = 1; i <= n; i++) {
        let name = document.getElementById(`name${i}`).value || `Subject ${i}`;
        let grade = document.getElementById(`grade${i}`).value;
        let credits = parseFloat(document.getElementById(`credits${i}`).value);

        if (!grade || isNaN(credits)) {
            alert("Please fill all subject details");
            return;
        }

        if (grade === "F") {
            alert(`You failed in ${name}`);
            return;
        }

        let points = gradeMap[grade] * credits;
        totalWeighted += points;
        totalCredits += credits;

        summaryBody.innerHTML += `
            <tr>
                <td>${name}</td>
                <td>${grade}</td>
                <td>${credits}</td>
                <td>${points}</td>
            </tr>
        `;
    }

    let sgpa = totalWeighted / totalCredits;

    let prevCGPA = parseFloat(document.getElementById("prevCGPA").value) || 0;
    let prevCredits = parseFloat(document.getElementById("prevCredits").value) || 0;

    let cgpa =
        (prevCGPA * prevCredits + sgpa * totalCredits) /
        (prevCredits + totalCredits);

    sgpa = sgpa.toFixed(2);
    cgpa = cgpa.toFixed(2);

    resultBox.classList.remove("hidden");
    summaryTable.classList.remove("hidden");

    resultBox.innerHTML = `
        <div><strong>SGPA:</strong> ${sgpa}</div>
        <div><strong>CGPA:</strong> ${cgpa}</div>
    `;
}

function resetCalculator() {
    location.reload();
}

function toggleDarkMode() {
    document.body.classList.toggle("dark");
}
</script>

</body>
</html>
